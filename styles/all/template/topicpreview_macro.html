{% macro renderTopicPreview(context) %}
	<div class="topic_preview_content" style="display: none;">
		{{ _self.renderPost(lang('FIRST_POST'), context.TOPIC_PREVIEW_FIRST_AVATAR, context.TOPIC_PREVIEW_FIRST_POST, 'first', context.TOPIC_PREVIEW_LAST_POST) }}

		{% if context.TOPIC_PREVIEW_LAST_POST %}
			{{ _self.renderPost(lang('LAST_POST'), context.TOPIC_PREVIEW_LAST_AVATAR, context.TOPIC_PREVIEW_LAST_POST, 'last', true) }}
		{% endif %}
	</div>
{% endmacro %}

{% macro renderPost(title, avatar, post_text, post_class, show_title) %}
	<div class="topic_preview_section">
		{% if show_title %}
			<strong class="topic_preview_section_title">{{ title }}</strong>
		{% endif %}
		<div class="topic_preview_post">
			{% if avatar %}
				<div class="topic_preview_avatar">
					{%- if avatar is iterable -%}{# iterable array is for phpBB4 #}
						{% include 'avatar.html' with {avatar_data: avatar} only %}
					{%- elseif avatar != constant('\\vse\\topicpreview\\core\\display::NO_AVATAR') -%}{# phpBB3 avatar fallback #}
						{{ avatar }}
					{%- else -%}{# phpBB3 fallback no avatar #}
						<div class="topic_preview_no_avatar"></div>
					{%- endif -%}
				</div>
			{% endif %}
			<div class="topic_preview_{{ post_class }}">{{ post_text }}</div>
		</div>
	</div>
{% endmacro %}
